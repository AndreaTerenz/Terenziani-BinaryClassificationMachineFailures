# Terenziani-BinaryClassificationMachineFailures

Work done for the 2023/2024 Project Work in ML & Data Mining, using data from the [Kaggle challenge of the same name](https://www.kaggle.com/competitions/playground-series-s3e17).

The data consisted in a set of various industrial devices, each described through attributes like torque or operating temperature, that did or did not suffer some kind of failure (class 1 and 0, respectively). The task was therefore a binary classification, which was done through several different models, from decision trees to a support vector machine. The resulting best estimator was a *random forest* model, with an accuracy of 93% and (more importantly) an average recall of 89%.

The main issue with the data is its extreme imbalance between majority and minority class. As shown in the notebook, this is solved by oversampling the minority class and by choosing an appropriate metric for tuning (specifically, the recall macro average).

## Project files

- `data.csv` is the dataset
- `BCMF.ipynb` is the notebook containing the code
- `cache/` is saved data that usually takes quite a long time to compute. All functions that access such data have arguments to manually regenerate such data. Specifically:
	- [pickle files](https://docs.python.org/3/library/pickle.html) storing the results of all grid searches, which are particularly slow to perform
	- pairplots

## Extra packages

Oversampling was done using the [`imbalanced-learn`](https://imbalanced-learn.org/stable/) Python package. This has to be manually installed (see below).

## Before running

### Google Colab

1. Upload the `cache` folder and `data.csv` to Google Drive
	- If `cache` is omitted, it will be regenerated automatically
2. Before running, complete the `cd` command in the first cell with the correct path from step 1

### On your PC

This project uses [pipenv](https://pipenv.pypa.io/en/latest/) to track its dependencies, listed in the included `Pipfile`, and at least Python 3.10 (though it hasn't been tested for lower versions - 3.10 is the one used by Colab but my laptop & desktop run 3.11).

1. Inside the project's root directory, run `pipenv install`
	- this will install the required packages and python version (if missing). Most importantly, it'll make sure to install scikit version *1.2.2* (to make sure the pickle files contain data generated by the same scikit installed on Colab)
	- this will output a name for the newly created environment (e.g., in my case "`BCMF-p3r9wMLm`")
2. Open the notebook with VSCode and click "Select kernel" > "Python environments", where you'll see (among others) the pipenv environment. Once selected, it'll be used automatically the next time you run the notebook.

